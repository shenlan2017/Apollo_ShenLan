load("@rules_cc//cc:defs.bzl", "cc_library")
load("//tools/platform:build_defs.bzl", "if_aarch64", "if_x86_64")

package(default_visibility = ["//visibility:public"])
licenses(["notice"])

cc_library(
    name = "pangolin",
    srcs = glob([
        "Pangolin/src/utils/*.cpp",
        "Pangolin/src/image/*.cpp",
        "Pangolin/src/log/*.cpp",
        "Pangolin/src/geometry/*.cpp",
        "Pangolin/src/utils/posix/*.cpp",
        "Pangolin/src/gl/*.cpp",
        "Pangolin/src/display/*.cpp",
        "Pangolin/src/handler/*.cpp",
        "Pangolin/src/plot/*.cpp",
        "Pangolin/src/var/*.cpp",
        "Pangolin/src/video/*.cpp",
        "Pangolin/src/plot/*.cpp",
    ]) + [
        "Pangolin/src/video/drivers/test.cpp",
        "Pangolin/src/video/drivers/images.cpp",
        "Pangolin/src/video/drivers/images_out.cpp",
        "Pangolin/src/video/drivers/split.cpp",
        "Pangolin/src/video/drivers/truncate.cpp",
        "Pangolin/src/video/drivers/pvn.cpp",
        "Pangolin/src/video/drivers/pango.cpp",
        "Pangolin/src/video/drivers/pango_video_output.cpp",
        "Pangolin/src/video/drivers/debayer.cpp",
        "Pangolin/src/video/drivers/shift.cpp",
        "Pangolin/src/video/drivers/mirror.cpp",
        "Pangolin/src/video/drivers/unpack.cpp",
        "Pangolin/src/video/drivers/pack.cpp",
        "Pangolin/src/video/drivers/join.cpp",
        "Pangolin/src/video/drivers/merge.cpp",
        "Pangolin/src/video/drivers/json.cpp",
        "Pangolin/src/video/drivers/thread.cpp",
        "Pangolin/src/video/drivers/shared_memory.cpp",
        "Pangolin/src/tools/video_viewer.cpp",
        # "Pangolin/src/display/device/display_headless.cpp",
        "Pangolin/src/display/device/display_x11.cpp",
        "Pangolin/src/fonts.cpp",
        "Pangolin/src/display/widgets/widgets.cpp",
        # "Pangolin/src/video/drivers/ffmpeg.cpp",
    ],
    includes = [
        "Pangolin/include/",
        "Pangolin/src/gl/",
    ],
    hdrs = glob([
        "Pangolin/include/pangolin/utils/*.h*",
        "Pangolin/include/pangolin/image/*.h*",
        "Pangolin/include/pangolin/log/*.h*",
        "Pangolin/include/pangolin/geometry/*.h*",
        "Pangolin/include/pangolin/utils/posix/*.h*",
        "Pangolin/include/pangolin/gl/*.h*",
        "Pangolin/include/pangolin/display/*.h*",
        "Pangolin/include/pangolin/handler/*.h*",
        "Pangolin/include/pangolin/plot/*.h*",
        "Pangolin/include/pangolin/var/*.h*",
        "Pangolin/include/pangolin/video/*.h*",
    ]) + [
        "Pangolin/include/pangolin/pangolin.h",
        "Pangolin/include/pangolin/platform.h",
        "Pangolin/include/pangolin/config.h",
        "Pangolin/include/pangolin/video_drivers.h",
        "Pangolin/include/pangolin/window_frameworks.h",
        "Pangolin/include/pangolin/video/drivers/test.h",
        "Pangolin/include/pangolin/video/drivers/images.h",
        "Pangolin/include/pangolin/video/drivers/images_out.h",
        "Pangolin/include/pangolin/video/drivers/split.h",
        "Pangolin/include/pangolin/video/drivers/truncate.h",
        "Pangolin/include/pangolin/video/drivers/pvn.h",
        "Pangolin/include/pangolin/video/drivers/pango.h",
        "Pangolin/include/pangolin/video/drivers/pango_video_output.h",
        "Pangolin/include/pangolin/video/drivers/debayer.h",
        "Pangolin/include/pangolin/video/drivers/shift.h",
        "Pangolin/include/pangolin/video/drivers/mirror.h",
        "Pangolin/include/pangolin/video/drivers/unpack.h",
        "Pangolin/include/pangolin/video/drivers/pack.h",
        "Pangolin/include/pangolin/video/drivers/join.h",
        "Pangolin/include/pangolin/video/drivers/merge.h",
        "Pangolin/include/pangolin/video/drivers/thread.h",
        "Pangolin/include/pangolin/video/drivers/shared_memory.h",
        "Pangolin/include/pangolin/tools/video_viewer.h",
        "Pangolin/include/pangolin/display/widgets/widgets.h",
        # "Pangolin/include/pangolin/video/drivers/ffmpeg.h",
        "Pangolin/src/gl/stb_truetype.h",
    ],
    deps = [
        "@eigen",
        "@opengl",
        "@glew",
        "@ffmpeg//:avcodec",
        "@ffmpeg//:avformat",
        "@ffmpeg//:swscale",
    ],
    strip_include_prefix = "Pangolin",       # 去除冗余的前缀
)
